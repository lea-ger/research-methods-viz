<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dark Patterns auf Webseiten</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=PT+Sans:ital,wght@0,400;0,700;1,400;1,700&family=Roboto+Slab:wght@100..900&display=swap"
          rel="stylesheet">
    <link rel="icon" href="./public/favicon.ico" type="image/x-icon">
    <style>
        * {
            margin: 0;
        }

        body, h2, h3, h4, h5, h6 {
            font-family: PT Sans, sans-serif;
        }

        h1 {
            font-family: Roboto Slab, serif;
        }

        .mi-green {
            background: rgb(5, 113, 176);
        }

        .mi-green-text {
            color: rgb(5, 113, 176);
        }

        .mi-pink {
            background: rgb(202, 0, 32);
        }

        .mi-pink-text {
            color: rgb(202, 0, 32);
        }

        td, th {
            padding: 8px;
            border-left: 2px solid hsla(348, 7%, 13%, 1);
        }

        td span {
            font-weight: bold;
        }

        td:first-child, th:first-child {
            border-left: none;
        }

        #description {
            margin-top: 8px;
            margin-bottom: 32px;
        }

        .charts {
            display: flex;
            flex-direction: row;
            gap: 8px;
            margin-top: 16px;
        }

        .charts > :not(:first-child) {
            border-left: 2px solid hsla(348, 7%, 13%, 1);
            padding-left: 20px;
        }

        h4 {
            margin-bottom: 4px;
        }

        .sus-container {
            margin-top: 16px;
            display: flex;
            flex-direction: row;
            align-items: start;
            gap: 32px
        }

        .sus {
            max-width: 45ch;
        }

        .would-i {
            margin-bottom: 16px;
            max-width: 45ch;
        }

        .popover {
          position: fixed;
          top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        .popover img {
            max-width: 60vw;
        }

        .popover::backdrop {
           background: rgb(190 190 190 / 50%);
        }

        button {
            margin-top: 4px;
            padding: 8px 16px;
            background-color: rgb(244, 165, 130);
            border: none;
            border-radius: 8px;
        }
        button + button {
            background-color: rgb(146, 197, 222);
        }

        body {
            max-height: 100vh;
            overflow-y: auto;
            padding: 32px;
        }

        table {
            border-spacing: 0;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.25rem;
            }
            #description {
                font-size: 0.875rem;
            }
            p {
                font-size: 0.675rem;
            }
            h2 {
                font-size: 1rem;
            }
            h3 {
                font-size: 0.875rem;
            }
            h4 {
                font-size: 0.75rem;
            }
            button {
                font-size: 0.65rem;
            }
            th {
                font-size: 0.75rem;
            }
            .charts {
                flex-wrap: wrap;
            }
            .charts > :nth-child(2) {
                border: none;
            }
            .popover img {
                max-width: 90vw;
            }
        }

        .relative {
            position: relative;
        }
    </style>
</head>

<body>
    <main>
        <h1>Dark Patterns auf Webseiten - Einschätzung von Informatikstudenten</h1>
        <p id="description">
            Auf dieser Website werden die Ergebnisse der Umfrage zur Einschätzung von <i>Dark Patterns</i> präsentiert. Es werden die einzelnen Ergebnisse visuell dargestellt und erläutert.<br/>
            Im Weiteren wurden Interfaces dargestellt welche entweder ein Dark Pattern enthielten oder nicht, da die Umfrage in einer AB Form durchführt worden ist. Die Antworten zu den einzelnen <i>Dark Pattern</i> werden nun dargestellt.
        </p>
        
        <div style="display: flex; flex-direction: row; gap: 64px; flex-wrap: wrap;">
            <div>
                <h2>Comparison Prevention</h2>
                <p>Die Vergleichbarkeit von Elementen wie z.B. Produkten wird bewusst durch verwirrendes Auflisten von schlecht vergleichbaren Eigenschaften erschwert.</p>
        
                <button popovertarget="cp-dp-popover">Zeige Interface Mit Dark Pattern</button>
                <button popovertarget="cp-n-dp-popover">Zeige Interface Ohne Dark Pattern</button>
        
                <div class="sus-container">
                    <div>
                        <h4>System Usability Scale</h4>
                        <p class="sus">Aufgrund der Antworten der Nutzer zu dem System Usability Scale wurden die folgenden Ergebnisse errechnet</p>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Mit Dark Pattern</th>
                                <th>Ohne Dark Pattern</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr id="cp"></tr>
                        </tbody>
                    </table>
                </div>
        
                <div class="charts">
                    <div>
                        <h4>Semantisches Differential</h4>
                        <div id="cp-plot"></div>
                    </div>
                    <div>
                        <h4 class="would-i">Ich könnte mir vorstellen eine ähnliche Implementierung des Produktes in der Entwicklung zu akzeptieren.</h4>
                        <div id="cp-boxplot"></div>
                    </div>
                    <div>
                        <h4 class="would-i">Was Dark Pattern wurde wahrscheinlich erkannt. (Analyse anhand der offenen Antworten)</h4>
                        <div id="cp-found" class="relative"></div>
                    </div>
                </div>
            </div>
        
            <div>
                <h2>Preselection</h2>
                <p>Bestimmte Formularelemente sind vorgefüllt mit einem für den Webseitenbetreiber vorteilhaften Wert.</p>
        
                <button popovertarget="pre-dp-popover">Zeige Interface Mit Dark Pattern</button>
                <button popovertarget="pre-n-dp-popover">Zeige Interface Ohne Dark Pattern</button>
        
                <div class="sus-container">
                    <div>
                        <h4>System Usability Scale</h4>
                        <p class="sus">Aufgrund der Antworten der Nutzer zu dem System Usability Scale wurden die folgenden Ergebnisse errechnet</p>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Mit Dark Pattern</th>
                                <th>Ohne Dark Pattern</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr id="pre" ></tr>
                        </tbody>
                    </table>
                </div>
        
                <div class="charts">
                    <div>
                        <h4>Semantisches Differential</h4>
                        <div id="pre-plot"></div>
                    </div>
                    <div>
                        <h4 class="would-i">Ich könnte mir vorstellen eine ähnliche Implementierung des Produktes in der Entwicklung zu akzeptieren.</h4>
                        <div id="pre-boxplot"></div>
                    </div>
                    <div>
                        <h4 class="would-i">Was Dark Pattern wurde wahrscheinlich erkannt. (Analyse anhand der offenen Antworten)</h4>
                        <div id="pre-found" class="relative"></div>
                    </div>
                </div>
            </div>
        
            <div>
                <h2>Hard to Cancel</h2>
                <p>Das Beenden einer für den Webseitenbetreiber vorteilhaften Interaktion ist zwar möglich, wird dem Nutzer jedoch bewusst erschwert.</p>
        
                <button popovertarget="hard-dp-popover">Zeige Interface Mit Dark Pattern</button>
                <button popovertarget="hard-n-dp-popover">Zeige Interface Ohne Dark Pattern</button>
        
                <div class="sus-container">
                    <div>
                        <h4>System Usability Scale</h4>
                        <p class="sus">Aufgrund der Antworten der Nutzer zu dem System Usability Scale wurden die folgenden Ergebnisse errechnet</p>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Mit Dark Pattern</th>
                                <th>Ohne Dark Pattern</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr id="hard"></tr>
                        </tbody>
                    </table>
                </div>
        
                <div class="charts">
                    <div>
                        <h4>Semantisches Differential</h4>
                        <div id="hard-plot"></div>
                    </div>
                    <div>
                        <h4 class="would-i">Ich könnte mir vorstellen eine ähnliche Implementierung des Produktes in der Entwicklung zu akzeptieren.</h4>
                        <div id="hard-boxplot"></div>
                    </div>
                    <div>
                        <h4 class="would-i">Was Dark Pattern wurde wahrscheinlich erkannt. (Analyse anhand der offenen Antworten)</h4>
                        <div id="hard-found" class="relative"></div>
                    </div>
                </div>
            </div>
        
            <div>
                <h2>Social Proof</h2>
                <p>Durch Hervorhebung positive Nutzerbeiträge soll die Seite oder bestimmte Beiträge legitimer wirken.</p>
        
                <button popovertarget="social-dp-popover">Zeige Interface Mit Dark Pattern</button>
                <button popovertarget="social-n-dp-popover">Zeige Interface Ohne Dark Pattern</button>
        
                <div class="sus-container">
                    <div>
                        <h4>System Usability Scale</h4>
                        <p class="sus">Aufgrund der Antworten der Nutzer zu dem System Usability Scale wurden die folgenden Ergebnisse errechnet</p>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Mit Dark Pattern</th>
                                <th>Ohne Dark Pattern</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr id="social"></tr>
                        </tbody>
                    </table>
                </div>
        
                <div class="charts">
                    <div>
                        <h4>Semantisches Differential</h4>
                        <div id="social-plot"></div>
                    </div>
                    <div>
                        <h4 class="would-i">Ich könnte mir vorstellen eine ähnliche Implementierung des Produktes in der Entwicklung zu akzeptieren.</h4>
                        <div id="social-boxplot"></div>
                    </div>
                    <div>
                        <h4 class="would-i">Was Dark Pattern wurde wahrscheinlich erkannt. (Analyse anhand der offenen Antworten)</h4>
                        <div id="social-found" class="relative"></div>
                    </div>
                </div>
            </div>
        
            <div>
                <h2>Forced Action</h2>
                <p>Eine Aktion muss vom Nutzer durchgeführt werden, egal ob gewollt oder nicht.</p>
        
                <button popovertarget="fa-dp-popover">Zeige Interface Mit Dark Pattern</button>
                <button popovertarget="fa-n-dp-popover">Zeige Interface Ohne Dark Pattern</button>
        
                <div class="sus-container">
                    <div>
                        <h4>System Usability Scale</h4>
                        <p class="sus">Aufgrund der Antworten der Nutzer zu dem System Usability Scale wurden die folgenden Ergebnisse errechnet</p>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Mit Dark Pattern</th>
                                <th>Ohne Dark Pattern</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr id="fa"></tr>
                        </tbody>
                    </table>
                </div>
        
                <div class="charts">
                    <div>
                        <h4>Semantisches Differential</h4>
                        <div id="fa-plot"></div>
                    </div>
                    <div>
                        <h4 class="would-i">Ich könnte mir vorstellen eine ähnliche Implementierung des Produktes in der Entwicklung zu akzeptieren.</h4>
                        <div id="fa-boxplot"></div>
                    </div>
                    <div>
                        <h4 class="would-i">Was Dark Pattern wurde wahrscheinlich erkannt. (Analyse anhand der offenen Antworten)</h4>
                        <div id="fa-found" class="relative"></div>
                    </div>
                </div>
            </div>
        
        </div>
    </main>
    
    <div id="cp-dp-popover" class="popover" popover>
        <h2>Comparison Prevention mit Dark Pattern</h2>
        <img src="./public/Comparison Prevention - DP.png" alt="Comparison Prevention Interface Mit Dark Pattern">
    </div>
    
    <div id="cp-n-dp-popover" class="popover" popover>
        <h2>Comparison Prevention ohne Dark Pattern</h2>
        <img src="./public/Comparison Prevention - No DP.png" alt="Comparison Prevention Interface Ohne Dark Pattern">
    </div>
    
    <div id="pre-dp-popover" class="popover" popover>
        <h2>Preselection mit Dark Pattern</h2>
        <img src="./public/Preselection - DP.png" alt="Preselection Interface Mit Dark Pattern">
    </div>
    
    <div id="pre-n-dp-popover" class="popover" popover>
        <h2>Preselection ohne Dark Pattern</h2>
        <img src="./public/Preselection - No DP.png" alt="Preselection Interface Ohne Dark Pattern">
    </div>
    
    <div id="hard-dp-popover" class="popover" popover>
        <h2>Hard to Cancel mit Dark Pattern</h2>
        <img src="./public/Hard to Cancel - DP.png" alt="Hard to Cancel Interface Mit Dark Pattern">
    </div>
    
    <div id="hard-n-dp-popover" class="popover" popover>
        <h2>Hard to Cancel ohne Dark Pattern</h2>
        <img src="./public/Hard to Cancel - No DP.png" alt="Hard to Cancel Interface Ohne Dark Pattern">
    </div>
    
    <div id="social-dp-popover" class="popover" popover>
        <h2>Social Proof mit Dark Pattern</h2>
        <img src="./public/Social Proof - DP.png" alt="Social Proof Interface Mit Dark Pattern">
    </div>
    
    <div id="social-n-dp-popover" class="popover" popover>
        <h2>Social Proof ohne Dark Pattern</h2>
        <img src="./public/Social Proof - No DP.png" alt="Social Proof Interface Ohne Dark Pattern">
    </div>
    
    <div id="fa-dp-popover" class="popover" popover>
        <h2>Forced Action mit Dark Pattern</h2>
        <img src="./public/Forced Action - DP.png" alt="Forced Action Interface Mit Dark Pattern">
    </div>
    
    <div id="fa-n-dp-popover" class="popover" popover>
        <h2>Forced Action ohne Dark Pattern</h2>
        <img src="./public/Forced Action - No DP.png" alt="Forced Action Interface Ohne Dark Pattern">
    </div>

<script type="module">
    import * as Plot from "https://cdn.jsdelivr.net/npm/@observablehq/plot@0.6/+esm";
    import * as d3 from "https://cdn.jsdelivr.net/npm/d3@7/+esm";

    //         [...document.querySelectorAll("tbody")].slice(9).map(table => {
    //     const [_1, question, _2, ...rows] = [...table.querySelectorAll("tr")]
    //     const answers = rows.slice(0, rows.length - 4)
    //     return {
    //         question: question.textContent,
    //         answers: answers.map(a => {
    //             const [label, answer] = a.querySelectorAll("td")
    //             return {
    //                 label: label.textContent,
    //                 answer: +answer.textContent
    //             }
    //         })
    //     }
    // })
    const generalQuestion = [
        {
            "question": "Frage: In welchem Studiengang (Bachelor/Master) studieren Sie?\n",
            "answers": [
                {
                    "label": "Bachelor (1)",
                    "answer": 12
                },
                {
                    "label": "Master (2)",
                    "answer": 5
                }
            ]
        },
        {
            "question": "Frage: Wie viel praktische Erfahrung haben Sie im Bereich der Software-Entwicklung?1 = Keine praktische Erfahrung; 5 = Professionelle Erfahrung\n",
            "answers": [
                {
                    "label": "1 (1)",
                    "answer": 0
                },
                {
                    "label": "2 (2)",
                    "answer": 6
                },
                {
                    "label": "3 (3)",
                    "answer": 4
                },
                {
                    "label": "4 (4)",
                    "answer": 5
                },
                {
                    "label": "5 (5)",
                    "answer": 2
                }
            ]
        },
        {
            "question": "Frage: In welchem Bereich liegt Ihr Interesse bei der Software Entwicklung primär?  \n",
            "answers": [
                {
                    "label": "Frontend Entwicklung (1)",
                    "answer": 3
                },
                {
                    "label": "Backend Entwicklung (2)",
                    "answer": 4
                },
                {
                    "label": "Fullstack Entwicklung (3)",
                    "answer": 10
                }
            ]
        },
        {
            "question": "Frage: Haben/Hatten Sie Berufserfahrung neben dem Studium?\n",
            "answers": [
                {
                    "label": "Vollzeitstelle (1)",
                    "answer": 2
                },
                {
                    "label": "Teilzeitstelle (2)",
                    "answer": 1
                },
                {
                    "label": "Werkstudentenstelle (3)",
                    "answer": 5
                },
                {
                    "label": "Praktikum (4)",
                    "answer": 1
                },
                {
                    "label": "Ausbildung (5)",
                    "answer": 0
                },
                {
                    "label": "Keine Berufserfahrung (6)",
                    "answer": 8
                },
                {
                    "label": "Sonstige (7) ",
                    "answer": 0
                }
            ]
        },
        {
            "question": "Frage: Wie schätzen Sie Ihre Erfahrung im Bereich UI/UX-Design ein?1 = Keine Erfahrung; 5 = Professionelle Erfahrung\n",
            "answers": [
                {
                    "label": "1 (1)",
                    "answer": 0
                },
                {
                    "label": "2 (2)",
                    "answer": 7
                },
                {
                    "label": "3 (3)",
                    "answer": 6
                },
                {
                    "label": "4 (4)",
                    "answer": 2
                },
                {
                    "label": "5 (5)",
                    "answer": 2
                }
            ]
        }
    ]

    const finalQuestions = [
        {
            "question": "Frage: Fallen Ihnen manipulative Designs bei Webseiten auf?\n",
            "answers": [
                {
                    "label": "noch nie (1)",
                    "answer": 0
                },
                {
                    "label": "selten (2)",
                    "answer": 0
                },
                {
                    "label": "ab und zu (3)",
                    "answer": 6
                },
                {
                    "label": "häufig (4)",
                    "answer": 2
                },
                {
                    "label": "(fast) immer (5)",
                    "answer": 4
                }
            ]
        },
        {
            "question": "Frage: Haben Sie ethische Konzepte während Ihres Studiums behandelt?\n",
            "answers": [
                {
                    "label": "Ja (1)",
                    "answer": 9
                },
                {
                    "label": "Nein (2)",
                    "answer": 3
                }
            ]
        },
        {
            "question": "Frage: Kennen Sie bestimmte ethische Leitfäden (z.B. ACM Leitlinien)?\n",
            "answers": [
                {
                    "label": "Ja (1)",
                    "answer": 8
                },
                {
                    "label": "Nein (2)",
                    "answer": 4
                }
            ]
        }
    ]

    // [...document.querySelectorAll("tbody")].slice(9).map((table, index) => {
    //      const [_1, question, _2, ...rows] = [...table.querySelectorAll("tr")]
    //     const offset = index === 2 ? 4 : 1;
    //     const answers = rows.slice(0, rows.length - offset)

    //     if (index === 2) return {
    //          question: question.textContent,
    //          answers: answers.map(a => {
    //             const [label, answer] = a.querySelectorAll("td")
    //             return {
    //                 label: label.textContent,
    //                 answer: +answer.textContent
    //             }
    //         })
    //      }

    //      if(index === 1) return {
    //          question: question.textContent,
    //          answers: answers.slice(1).map((a, ia) => {
    //             const [label, ...nestedRows] = a.querySelectorAll("td")
    //              const nestedAnswers = nestedRows.slice(0, 5)

    //              return {
    //                 label: label.textContent,
    //                 answers: nestedAnswers.map(na => {
    //                     return ++na.textContent.match(/\((\d+)\)/)[1]
    //                 })
    //             }
    //         })
    //      }

    //     const lastRow = +rows[rows.length -1].textContent.match(/n = (\d)+/)[1]

    //      return {
    //          question: question.textContent,
    //          answers: answers.slice(1).reduce((acc, a, ia) => {
    //             const [label, ...nestedRows] = a.querySelectorAll("td")
    //              const nestedAnswers = nestedRows.slice(0, 5)

    //              const score = nestedAnswers.reduce((acc, na, i) => {
    //                     const num = +na.textContent.match(/\((\d+)\)/)[1]
    //                     return acc + ([0, 2, 4].includes(ia) ? i : (4 - i)) * num
    //                 }, 0) * 2.5

    //             return acc + score
    //         }, 0) / lastRow
    //      }
    //  })

    const resCp = document.getElementById("cp");
    const plotCp = document.getElementById("cp-plot");
    const boxplotCp = document.getElementById("cp-boxplot");
    const cpFound = document.getElementById("cp-found");

    const resPre = document.getElementById("pre");
    const plotPre = document.getElementById("pre-plot");
    const boxplotPre = document.getElementById("pre-boxplot");
    const preFound = document.getElementById("pre-found");

    const resHard = document.getElementById("hard");
    const plotHard = document.getElementById("hard-plot");
    const boxplotHard = document.getElementById("hard-boxplot");
    const hardFound = document.getElementById("hard-found");

    const resSocial = document.getElementById("social");
    const plotSocial = document.getElementById("social-plot");
    const boxplotSocial = document.getElementById("social-boxplot");
    const socialFound = document.getElementById("social-found");

    const resFa = document.getElementById("fa");
    const plotFa = document.getElementById("fa-plot");
    const boxplotFa = document.getElementById("fa-boxplot");
    const faFound = document.getElementById("fa-found");

    const cpndp = [
    {
        "question": "Frage: Systemnutzbarkeit1 = Stimme überhaupt nicht zu; 5 = Stimme voll und ganz zu\n",
        "answers": 30.5
    },
    {
        "question": "Frage: Einschätzung der User ExperienceWählen Sie passende Attribute aus, die auf das gezeigte Interface zutreffen.\n",
        "answers": [
            {
                "label": "Einfach - Kompliziert",
                "answers": [
                    3,
                    2,
                    2,
                    2,
                    1
                ]
            },
            {
                "label": "Klar - Verwirrend",
                "answers": [
                    2,
                    3,
                    1,
                    2,
                    2
                ]
            },
            {
                "label": "Vertrauenswürdig - Unvertrauenswürdig",
                "answers": [
                    1,
                    3,
                    3,
                    2,
                    1
                ]
            },
            {
                "label": "Transparent - Verschleiert",
                "answers": [
                    2,
                    2,
                    2,
                    2,
                    2
                ]
            },
            {
                "label": "Hilfreich - Irreführend",
                "answers": [
                    2,
                    3,
                    1,
                    3,
                    1
                ]
            },
            {
                "label": "Intuitiv - Unlogisch",
                "answers": [
                    2,
                    2,
                    3,
                    2,
                    1
                ]
            },
            {
                "label": "Ehrlich - Manipulativ",
                "answers": [
                    1,
                    3,
                    1,
                    2,
                    2
                ]
            },
            {
                "label": "Sicher - Kompromittierend",
                "answers": [
                    2,
                    3,
                    3,
                    1,
                    1
                ]
            }
        ]
    },
    {
        "question": "Frage: Ich könnte mir vorstellen eine ähnliche Implementierung des Produktes in der Entwicklung zu akzeptieren.1 = Stimme überhaupt nicht zu; 5 = Stimme voll und ganz zu\n",
        "answers": [
            {
                "label": "1 (1)",
                "answer": 0
            },
            {
                "label": "2 (2)",
                "answer": 1
            },
            {
                "label": "3 (3)",
                "answer": 1
            },
            {
                "label": "4 (4)",
                "answer": 1
            },
            {
                "label": "5 (5)",
                "answer": 2
            }
        ]
    },
]
    const predp = [
    {
        "question": "Frage: System Nutzbarkeit1 = Stimme überhaupt nicht zu; 5 = Stimme voll und ganz zu\n",
        "answers": 40
    },
    {
        "question": "Frage: Einschätzung der User ExperienceWählen Sie passende Attribute aus, die auf das gezeigte Interface zutreffen.\n",
        "answers": [
            {
                "label": "Einfach - Kompliziert",
                "answers": [
                    3,
                    2,
                    1,
                    2,
                    1
                ]
            },
            {
                "label": "Klar - Verwirrend",
                "answers": [
                    3,
                    1,
                    1,
                    3,
                    1
                ]
            },
            {
                "label": "Vertrauenswürdig - Unvertrauenswürdig",
                "answers": [
                    2,
                    2,
                    1,
                    3,
                    1
                ]
            },
            {
                "label": "Transparent - Verschleiert",
                "answers": [
                    2,
                    2,
                    2,
                    2,
                    1
                ]
            },
            {
                "label": "Hilfreich - Irreführend",
                "answers": [
                    3,
                    1,
                    2,
                    2,
                    1
                ]
            },
            {
                "label": "Intuitiv - Unlogisch",
                "answers": [
                    4,
                    1,
                    1,
                    1,
                    2
                ]
            },
            {
                "label": "Ehrlich - Manipulativ",
                "answers": [
                    3,
                    1,
                    2,
                    2,
                    1
                ]
            },
            {
                "label": "Sicher - Kompromittierend",
                "answers": [
                    3,
                    2,
                    1,
                    2,
                    1
                ]
            }
        ]
    },
    {
        "question": "Frage: Ich könnte mir vorstellen eine ähnliche Implementierung des Produktes in der Entwicklung zu akzeptieren.1 = Stimme überhaupt nicht zu; 5 = Stimme voll und ganz zu\n",
        "answers": [
            {
                "label": "1 (1)",
                "answer": 1
            },
            {
                "label": "2 (2)",
                "answer": 1
            },
            {
                "label": "3 (3)",
                "answer": 0
            },
            {
                "label": "4 (4)",
                "answer": 0
            },
            {
                "label": "5 (5)",
                "answer": 2
            }
        ]
    }
]
    const harddp = [
    {
        "question": "Frage: Systemnutzbarkeit1 = Stimme überhaupt nicht zu; 5 = Stimme voll und ganz zu\n",
        "answers": 22.5
    },
    {
        "question": "Frage: Einschätzung der User ExperienceWählen Sie passende Attribute aus, die auf das gezeigte Interface zutreffen.\n",
        "answers": [
            {
                "label": "Einfach - Kompliziert",
                "answers": [
                    3,
                    2,
                    1,
                    2,
                    1
                ]
            },
            {
                "label": "Klar - Verwirrend",
                "answers": [
                    2,
                    1,
                    2,
                    1,
                    3
                ]
            },
            {
                "label": "Vertrauenswürdig - Unvertrauenswürdig",
                "answers": [
                    2,
                    1,
                    2,
                    2,
                    2
                ]
            },
            {
                "label": "Transparent - Verschleiert",
                "answers": [
                    1,
                    1,
                    4,
                    1,
                    2
                ]
            },
            {
                "label": "Hilfreich - Irreführend",
                "answers": [
                    1,
                    3,
                    1,
                    1,
                    3
                ]
            },
            {
                "label": "Intuitiv - Unlogisch",
                "answers": [
                    1,
                    2,
                    2,
                    2,
                    2
                ]
            },
            {
                "label": "Ehrlich - Manipulativ",
                "answers": [
                    1,
                    1,
                    2,
                    2,
                    3
                ]
            },
            {
                "label": "Sicher - Kompromittierend",
                "answers": [
                    2,
                    1,
                    4,
                    1,
                    1
                ]
            }
        ]
    },
    {
        "question": "Frage: Ich könnte mir vorstellen eine ähnliche Implementierung des Produktes in der Entwicklung zu akzeptieren.1 = Stimme überhaupt nicht zu; 5 = Stimme voll und ganz zu\n",
        "answers": [
            {
                "label": "1 (1)",
                "answer": 1
            },
            {
                "label": "2 (2)",
                "answer": 2
            },
            {
                "label": "3 (3)",
                "answer": 0
            },
            {
                "label": "4 (4)",
                "answer": 1
            },
            {
                "label": "5 (5)",
                "answer": 0
            }
        ]
    }
]
    const socialndop = [
    {
        "question": "Frage: Systemnutzbarkeit1 = Stimme überhaupt nicht zu; 5 = Stimme voll und ganz zu\n",
        "answers": 40.625
    },
    {
        "question": "Frage: Einschätzung der User ExperienceWählen Sie passende Attribute aus, die auf das gezeigte Interface zutreffen.\n",
        "answers": [
            {
                "label": "Einfach - Kompliziert",
                "answers": [
                    4,
                    2,
                    1,
                    1,
                    1
                ]
            },
            {
                "label": "Klar - Verwirrend",
                "answers": [
                    5,
                    1,
                    1,
                    1,
                    1
                ]
            },
            {
                "label": "Vertrauenswürdig - Unvertrauenswürdig",
                "answers": [
                    2,
                    3,
                    2,
                    1,
                    1
                ]
            },
            {
                "label": "Transparent - Verschleiert",
                "answers": [
                    4,
                    2,
                    1,
                    1,
                    1
                ]
            },
            {
                "label": "Hilfreich - Irreführend",
                "answers": [
                    4,
                    2,
                    1,
                    1,
                    1
                ]
            },
            {
                "label": "Intuitiv - Unlogisch",
                "answers": [
                    4,
                    2,
                    1,
                    1,
                    1
                ]
            },
            {
                "label": "Ehrlich - Manipulativ",
                "answers": [
                    4,
                    2,
                    1,
                    1,
                    1
                ]
            },
            {
                "label": "Sicher - Kompromittierend",
                "answers": [
                    5,
                    1,
                    1,
                    1,
                    1
                ]
            }
        ]
    },
    {
        "question": "Frage: Ich könnte mir vorstellen eine ähnliche Implementierung des Produktes in der Entwicklung zu akzeptieren.1 = Stimme überhaupt nicht zu; 5 = Stimme voll und ganz zu\n",
        "answers": [
            {
                "label": "1 (1)",
                "answer": 1
            },
            {
                "label": "2 (2)",
                "answer": 0
            },
            {
                "label": "3 (3)",
                "answer": 0
            },
            {
                "label": "4 (4)",
                "answer": 1
            },
            {
                "label": "5 (5)",
                "answer": 2
            }
        ]
    }
]
    const fadp = [
    {
        "question": "Frage: Systemnutzbarkeit1 = Stimme überhaupt nicht zu; 5 = Stimme voll und ganz zu\n",
        "answers": 38.75
    },
    {
        "question": "Frage: Einschätzung der User ExperienceWählen Sie passende Attribute aus, die auf das gezeigte Interface zutreffen.\n",
        "answers": [
            {
                "label": "Einfach - Kompliziert",
                "answers": [
                    5,
                    1,
                    1,
                    1,
                    1
                ]
            },
            {
                "label": "Klar - Verwirrend",
                "answers": [
                    4,
                    2,
                    1,
                    1,
                    1
                ]
            },
            {
                "label": "Vertrauenswürdig - Unvertrauenswürdig",
                "answers": [
                    2,
                    1,
                    3,
                    2,
                    1
                ]
            },
            {
                "label": "Transparent - Verschleiert",
                "answers": [
                    2,
                    3,
                    1,
                    2,
                    1
                ]
            },
            {
                "label": "Hilfreich - Irreführend",
                "answers": [
                    2,
                    2,
                    2,
                    1,
                    1
                ]
            },
            {
                "label": "Intuitiv - Unlogisch",
                "answers": [
                    3,
                    2,
                    2,
                    1,
                    1
                ]
            },
            {
                "label": "Ehrlich - Manipulativ",
                "answers": [
                    3,
                    2,
                    1,
                    2,
                    1
                ]
            },
            {
                "label": "Sicher - Kompromittierend",
                "answers": [
                    2,
                    2,
                    3,
                    1,
                    1
                ]
            }
        ]
    },
    {
        "question": "Frage: Ich könnte mir vorstellen eine ähnliche Implementierung des Produktes in der Entwicklung zu akzeptieren.1 = Stimme überhaupt nicht zu; 5 = Stimme voll und ganz zu\n",
        "answers": [
            {
                "label": "1 (1)",
                "answer": 0
            },
            {
                "label": "2 (2)",
                "answer": 0
            },
            {
                "label": "3 (3)",
                "answer": 1
            },
            {
                "label": "4 (4)",
                "answer": 0
            },
            {
                "label": "5 (5)",
                "answer": 3
            }
        ]
    }
]
    const cpdp = [
    {
        "question": "Frage: Systemnutzbarkeit1 = Stimme überhaupt nicht zu; 5 = Stimme voll und ganz zu\n",
        "answers": 25.625
    },
    {
        "question": "Frage: Einschätzung der User ExperienceWählen Sie passende Attribute aus, die auf das gezeigte Interface zutreffen.\n",
        "answers": [
            {
                "label": "Einfach - Kompliziert",
                "answers": [
                    4,
                    4,
                    1,
                    2,
                    2
                ]
            },
            {
                "label": "Klar - Verwirrend",
                "answers": [
                    3,
                    3,
                    2,
                    4,
                    1
                ]
            },
            {
                "label": "Vertrauenswürdig - Unvertrauenswürdig",
                "answers": [
                    2,
                    2,
                    2,
                    5,
                    2
                ]
            },
            {
                "label": "Transparent - Verschleiert",
                "answers": [
                    2,
                    2,
                    3,
                    3,
                    3
                ]
            },
            {
                "label": "Hilfreich - Irreführend",
                "answers": [
                    1,
                    2,
                    4,
                    5,
                    1
                ]
            },
            {
                "label": "Intuitiv - Unlogisch",
                "answers": [
                    3,
                    4,
                    2,
                    3,
                    1
                ]
            },
            {
                "label": "Ehrlich - Manipulativ",
                "answers": [
                    2,
                    1,
                    3,
                    3,
                    4
                ]
            },
            {
                "label": "Sicher - Kompromittierend",
                "answers": [
                    3,
                    4,
                    3,
                    2,
                    1
                ]
            }
        ]
    },
    {
        "question": "Frage: Ich könnte mir vorstellen eine ähnliche Implementierung des Produktes in der Entwicklung zu akzeptieren.1 = Stimme überhaupt nicht zu; 5 = Stimme voll und ganz zu\n",
        "answers": [
            {
                "label": "1 (1)",
                "answer": 1
            },
            {
                "label": "2 (2)",
                "answer": 3
            },
            {
                "label": "3 (3)",
                "answer": 2
            },
            {
                "label": "4 (4)",
                "answer": 0
            },
            {
                "label": "5 (5)",
                "answer": 2
            }
        ]
    }
]
    const prendp = [
    {
        "question": "Frage: Systemnutzbarkeit1 = Stimme überhaupt nicht zu; 5 = Stimme voll und ganz zu\n",
        "answers": 32.5
    },
    {
        "question": "Frage: Einschätzung der User ExperienceWählen Sie passende Attribute aus, die auf das gezeigte Interface zutreffen.\n",
        "answers": [
            {
                "label": "Einfach - Kompliziert",
                "answers": [
                    4,
                    4,
                    2,
                    1,
                    2
                ]
            },
            {
                "label": "Klar - Verwirrend",
                "answers": [
                    4,
                    2,
                    4,
                    1,
                    2
                ]
            },
            {
                "label": "Vertrauenswürdig - Unvertrauenswürdig",
                "answers": [
                    4,
                    2,
                    4,
                    2,
                    1
                ]
            },
            {
                "label": "Transparent - Verschleiert",
                "answers": [
                    5,
                    2,
                    3,
                    1,
                    2
                ]
            },
            {
                "label": "Hilfreich - Irreführend",
                "answers": [
                    4,
                    2,
                    3,
                    3,
                    1
                ]
            },
            {
                "label": "Intuitiv - Unlogisch",
                "answers": [
                    5,
                    4,
                    1,
                    2,
                    1
                ]
            },
            {
                "label": "Ehrlich - Manipulativ",
                "answers": [
                    4,
                    3,
                    2,
                    2,
                    2
                ]
            },
            {
                "label": "Sicher - Kompromittierend",
                "answers": [
                    3,
                    4,
                    4,
                    1,
                    1
                ]
            }
        ]
    },
    {
        "question": "Frage: Ich könnte mir vorstellen eine ähnliche Implementierung des Produktes in der Entwicklung zu akzeptieren.1 = Stimme überhaupt nicht zu; 5 = Stimme voll und ganz zu\n",
        "answers": [
            {
                "label": "1 (1)",
                "answer": 2
            },
            {
                "label": "2 (2)",
                "answer": 0
            },
            {
                "label": "3 (3)",
                "answer": 2
            },
            {
                "label": "4 (4)",
                "answer": 2
            },
            {
                "label": "5 (5)",
                "answer": 2
            }
        ]
    }
]
    const hardndp = [
    {
        "question": "Frage: Systemnutzbarkeit1 = Stimme überhaupt nicht zu; 5 = Stimme voll und ganz zu\n",
        "answers": 32.5
    },
    {
        "question": "Frage: Einschätzung der User ExperienceWählen Sie passende Attribute aus, die auf das gezeigte Interface zutreffen.\n",
        "answers": [
            {
                "label": "Einfach - Kompliziert",
                "answers": [
                    4,
                    2,
                    2,
                    3,
                    2
                ]
            },
            {
                "label": "Klar - Verwirrend",
                "answers": [
                    3,
                    3,
                    2,
                    3,
                    2
                ]
            },
            {
                "label": "Vertrauenswürdig - Unvertrauenswürdig",
                "answers": [
                    4,
                    4,
                    2,
                    1,
                    2
                ]
            },
            {
                "label": "Transparent - Verschleiert",
                "answers": [
                    4,
                    4,
                    2,
                    1,
                    2
                ]
            },
            {
                "label": "Hilfreich - Irreführend",
                "answers": [
                    3,
                    4,
                    2,
                    2,
                    2
                ]
            },
            {
                "label": "Intuitiv - Unlogisch",
                "answers": [
                    4,
                    3,
                    2,
                    2,
                    2
                ]
            },
            {
                "label": "Ehrlich - Manipulativ",
                "answers": [
                    5,
                    2,
                    3,
                    1,
                    2
                ]
            },
            {
                "label": "Sicher - Kompromittierend",
                "answers": [
                    3,
                    4,
                    3,
                    1,
                    2
                ]
            }
        ]
    },
    {
        "question": "Frage: Ich könnte mir vorstellen eine ähnliche Implementierung des Produktes in der Entwicklung zu akzeptieren.1 = Stimme überhaupt nicht zu; 5 = Stimme voll und ganz zu\n",
        "answers": [
            {
                "label": "1 (1)",
                "answer": 1
            },
            {
                "label": "2 (2)",
                "answer": 0
            },
            {
                "label": "3 (3)",
                "answer": 3
            },
            {
                "label": "4 (4)",
                "answer": 2
            },
            {
                "label": "5 (5)",
                "answer": 2
            }
        ]
    }
]
    const socialdp = [
    {
        "question": "Frage: Systemnutzbarkeit1 = Stimme überhaupt nicht zu; 5 = Stimme voll und ganz zu\n",
        "answers": 29.6875
    },
    {
        "question": "Frage: Einschätzung der User ExperienceWählen Sie passende Attribute aus, die auf das gezeigte Interface zutreffen.\n",
        "answers": [
            {
                "label": "Einfach - Kompliziert",
                "answers": [
                    3,
                    3,
                    4,
                    2,
                    1
                ]
            },
            {
                "label": "Klar - Verwirrend",
                "answers": [
                    3,
                    1,
                    5,
                    3,
                    1
                ]
            },
            {
                "label": "Vertrauenswürdig - Unvertrauenswürdig",
                "answers": [
                    1,
                    2,
                    5,
                    4,
                    1
                ]
            },
            {
                "label": "Transparent - Verschleiert",
                "answers": [
                    1,
                    5,
                    5,
                    1,
                    1
                ]
            },
            {
                "label": "Hilfreich - Irreführend",
                "answers": [
                    1,
                    6,
                    4,
                    1,
                    1
                ]
            },
            {
                "label": "Intuitiv - Unlogisch",
                "answers": [
                    2,
                    4,
                    5,
                    1,
                    1
                ]
            },
            {
                "label": "Ehrlich - Manipulativ",
                "answers": [
                    1,
                    4,
                    5,
                    2,
                    1
                ]
            },
            {
                "label": "Sicher - Kompromittierend",
                "answers": [
                    2,
                    3,
                    6,
                    1,
                    1
                ]
            }
        ]
    },
    {
        "question": "Frage: Ich könnte mir vorstellen eine ähnliche Implementierung des Produktes in der Entwicklung zu akzeptieren.1 = Stimme überhaupt nicht zu; 5 = Stimme voll und ganz zu\n",
        "answers": [
            {
                "label": "1 (1)",
                "answer": 1
            },
            {
                "label": "2 (2)",
                "answer": 2
            },
            {
                "label": "3 (3)",
                "answer": 3
            },
            {
                "label": "4 (4)",
                "answer": 1
            },
            {
                "label": "5 (5)",
                "answer": 1
            }
        ]
    }
]
    const fandp = [
    {
        "question": "Frage: Systemnutzbarkeit1 = Stimme überhaupt nicht zu; 5 = Stimme voll und ganz zu\n",
        "answers": 35
    },
    {
        "question": "Frage: Einschätzung der User ExperienceWählen Sie passende Attribute aus, die auf das gezeigte Interface zutreffen.\n",
        "answers": [
            {
                "label": "Einfach - Kompliziert",
                "answers": [
                    5,
                    4,
                    1,
                    2,
                    1
                ]
            },
            {
                "label": "Klar - Verwirrend",
                "answers": [
                    4,
                    5,
                    1,
                    2,
                    1
                ]
            },
            {
                "label": "Vertrauenswürdig - Unvertrauenswürdig",
                "answers": [
                    2,
                    3,
                    4,
                    2,
                    2
                ]
            },
            {
                "label": "Transparent - Verschleiert",
                "answers": [
                    2,
                    4,
                    2,
                    2,
                    3
                ]
            },
            {
                "label": "Hilfreich - Irreführend",
                "answers": [
                    2,
                    3,
                    4,
                    3,
                    1
                ]
            },
            {
                "label": "Intuitiv - Unlogisch",
                "answers": [
                    6,
                    2,
                    2,
                    2,
                    1
                ]
            },
            {
                "label": "Ehrlich - Manipulativ",
                "answers": [
                    2,
                    3,
                    4,
                    2,
                    2
                ]
            },
            {
                "label": "Sicher - Kompromittierend",
                "answers": [
                    3,
                    2,
                    2,
                    5,
                    1
                ]
            }
        ]
    },
    {
        "question": "Frage: Ich könnte mir vorstellen eine ähnliche Implementierung des Produktes in der Entwicklung zu akzeptieren.1 = Stimme überhaupt nicht zu; 5 = Stimme voll und ganz zu\n",
        "answers": [
            {
                "label": "1 (1)",
                "answer": 1
            },
            {
                "label": "2 (2)",
                "answer": 1
            },
            {
                "label": "3 (3)",
                "answer": 3
            },
            {
                "label": "4 (4)",
                "answer": 1
            },
            {
                "label": "5 (5)",
                "answer": 2
            }
        ]
    }
]

    const foundDarkPattern = [
        [{label: "comparison prevention", value: 5, didFind: true, total: 8, wouldUse: [3, 1, 1]},
        {label: "comparison prevention", value: 3, didFind: false, total: 8, wouldUse: [1, 1, 1]},],
        [{label: "preselection", value: 1, didFind: true, total: 4, wouldUse: [1, 0, 0]},
        {label: "preselection", value: 3, didFind: false, total: 4, wouldUse: [1, 0, 2], },],
        [{label: "hard to cancel", value: 4, didFind: true, total: 4, wouldUse: [3, 0, 1]},
        {label: "hard to cancel", value: 0, didFind: false, total: 4, wouldUse: [0, 0, 0]},],
        [{label: "social proof", value: 0, didFind: true, total: 8, wouldUse: [0, 0, 0]},
        {label: "social proof", value: 8, didFind: false, total: 8, wouldUse: [3, 3, 2]},],
        [{label: "forced action", value: 2, didFind: true, total: 4, wouldUse: [0, 0, 2]},
        {label: "forced action", value: 2, didFind: false, total: 4, wouldUse: [0, 1, 1]},],
    ]

    ;[cpFound, preFound, hardFound, socialFound, faFound].forEach((plot, i) => {
        const w = 250
        const height = Math.min(w, 500);
        const radius = Math.min(w, height) / 2;

        const test = i === 0

        const data = foundDarkPattern[i];
        const yesData = data[0].wouldUse;
        const noData = data[1].wouldUse;

        const arc = d3.arc().innerRadius(radius * 0.6).outerRadius(radius - 1);
        const nestedArc = d3.arc().innerRadius(radius * 0.2).outerRadius(radius  * 0.575);
        const pie = d3.pie().padAngle(1 / radius).sort(null).value(d => d.value);

        const arcs = pie(data);

        const nestedPieYes = d3.pie().padAngle(1 / (radius + 20)).startAngle(arcs[0].startAngle).endAngle(arcs[0].endAngle).sort(null).value(d => d);
        const nestedArcsYes = nestedPieYes(yesData);
        const svgNestedYes = d3.create("svg").attr("style", "position: absolute; inset: 0").attr("viewBox", [-(w + 20) / 2, -(height + 20) / 2, w + 20, height + 20]).attr("width", w + 20).attr("height", height + 20);
        svgNestedYes.append("g").selectAll().data(nestedArcsYes).join("path")
            .attr("fill", d => ["#0571b0", "#f7f7f7", "#ca0020"][d.index])
            .attr("d", nestedArc);
            svgNestedYes.append("g")
            .attr("font-family", "sans-serif")
            .attr("font-size", 12)
            .attr("text-anchor", "middle")
            .selectAll()
            .data(nestedArcsYes)
            .join("text")
            .attr("transform", d => `translate(${nestedArc.centroid(d)})`)
            .call(text => text.append("tspan")).attr("y", "-0.4em").attr("font-weight", "bold").text(d => ["<0", "0", ">0"][d.index])
            .call(text => text.filter(d => (d.endAngle - d.startAngle) > 0.25).append("tspan")
                .attr("x", 0)
                .attr("y", "0.7em")
                .attr("fill-opacity", 0.7)
                .text(d => d.data / data[0].total * 100 + "%"));
            
        plot.appendChild(svgNestedYes.node());

        const nestedPieNo = d3.pie().padAngle(1 / (radius + 20)).startAngle(arcs[1].startAngle).endAngle(arcs[1].endAngle).sort(null).value(d => d);
        const nestedArcsNo = nestedPieNo(yesData);
        const svgNestedNo = d3.create("svg").attr("style", "position: absolute; inset: 0").attr("viewBox", [-(w + 20) / 2, -(height + 20) / 2, w + 20, height + 20]).attr("width", w + 20).attr("height", height + 20);
        svgNestedNo.append("g").selectAll().data(nestedArcsNo).join("path")
            .attr("fill", d => ["#0571b0", "#f7f7f7", "#ca0020"][d.index])
            .attr("d", nestedArc);
            svgNestedNo.append("g")
            .attr("font-family", "sans-serif")
            .attr("font-size", 12)
            .attr("text-anchor", "middle")
            .selectAll()
            .data(nestedArcsNo)
            .join("text")
            .attr("transform", d => `translate(${nestedArc.centroid(d)})`)
            .call(text => text.append("tspan")).attr("y", "-0.4em").attr("font-weight", "bold").text(d => ["<0", "0", ">0"][d.index])
            .call(text => text.filter(d => (d.endAngle - d.startAngle) > 0.25).append("tspan")
                .attr("x", 0)
                .attr("y", "0.7em")
                .attr("fill-opacity", 0.7)
                .text(d => d.data / data[0].total * 100 + "%"));
            
        plot.appendChild(svgNestedNo.node());

        const svg = d3.create("svg").attr("style", "position: absolute; inset: 0; margin: 10px").attr("viewBox", [-w / 2, -height / 2, w, height]).attr("width", w).attr("height", height);
        svg.append("g").selectAll().data(arcs).join("path")
            .attr("fill", d => d.data.didFind ? "#67a9cf" : "#ef8a62")
            .attr("d", arc);
        svg.append("g")
            .attr("font-family", "sans-serif")
            .attr("font-size", 12)
            .attr("text-anchor", "middle")
            .selectAll()
            .data(arcs)
            .join("text")
            .attr("transform", d => `translate(${arc.centroid(d)})`)
            .call(text => text.append("tspan")).attr("y", "-0.4em").attr("font-weight", "bold").text(d => d.data.didFind ? "Ja" : "Nein")
            .call(text => text.filter(d => (d.endAngle - d.startAngle) > 0.25).append("tspan")
                .attr("x", 0)
                .attr("y", "0.7em")
                .attr("fill-opacity", 0.7)
                .text(d => d.data.value / d.data.total * 100 + "%"));

            plot.appendChild(svg.node());
    })

    const results = {
        "comparison prevention": {
            "dark pattern": cpdp,
            "no dark pattern": cpndp
        },
        "preselection": {
            "dark pattern": predp,
            "no dark pattern": prendp
        },
        "hard to cancel": {
            "dark pattern": harddp,
            "no dark pattern": hardndp
        },
        "social proof": {
            "dark pattern": socialdp,
            "no dark pattern": socialndop
        },
        "forced action": {
            "dark pattern": fadp,
            "no dark pattern": fandp
        }
    }

    function generateTableHTML(category, results) {
        return `
        <td><span class="mi-pink-text">${results[category]["dark pattern"][0].answers}</span></td>
        <td><span class="mi-green-text">${results[category]["no dark pattern"][0].answers}</span></td>
    `;
    }

    resCp.innerHTML = generateTableHTML("comparison prevention", results);
    resPre.innerHTML = generateTableHTML("preselection", results);
    resHard.innerHTML = generateTableHTML("hard to cancel", results);
    resSocial.innerHTML = generateTableHTML("social proof", results);
    resFa.innerHTML = generateTableHTML("forced action", results);

    function mapForBarChart(data) {
        return data.flatMap(r => {
            return r.answers.flatMap((a, i) => {
                return Array.from({length: a}, () => ({
                    labelPositive: r.label.split(" - ")[0],
                    labelNegative: r.label.split(" - ")[1],
                    answer: i + 1
                }))
            })
        })
    }

    function Likert(responses) {
        const map = new Map(responses);
        return {
            order: Array.from(map.keys()),
            offset(I, X1, X2, Z) {
                for (const stacks of I) {
                    for (const stack of stacks) {
                        const k = d3.sum(stack, (i) => (X2[i] - X1[i]) * (1 - map.get(Z[i]))) / 2;
                        for (const i of stack) {
                            X1[i] -= k;
                            X2[i] -= k;
                        }
                    }
                }
            }
        };
    }

    const likert = Likert([
            [1, -1],
            [2, -1],
            [3, 0],
            [4, 1],
            [5, 1]
        ])

    ;[plotCp, plotPre, plotHard, plotSocial, plotFa].forEach((plot, i) => {
        const datasets = results[Object.keys(results)[i]]
        const diffResults1 = mapForBarChart(datasets["dark pattern"][1].answers)
        const diffResults2 = mapForBarChart(datasets["no dark pattern"][1].answers)

        ;[diffResults1, diffResults2].forEach((data, i) => {
            const chart = Plot.plot({
                marginLeft: 100,
                marginRight: 100,
                x: {tickFormat: "%", label: "Antworten (%)", grid: true, domain: [-0.8, 0.8]},
                y: {tickSize: 0},
                facet: {data: data, y: "labelPositive", label: i === 0 ? "Dark Pattern" : "No Dark Pattern"},
                color: {domain: likert.order, scheme: "BuRd"},
                marks: [
                    Plot.barX(
                        data,
                        Plot.groupZ(
                            {x: "proportion-facet"},
                            {
                                fill: "answer",
                                stroke: "#777",
                                strokeWidth: 0.5,
                                ...likert
                            }
                        )
                    ),
                    Plot.textX(
                        data,
                        Plot.groupZ(
                            {x: (e) => .81, text: "first"},
                            {text: (d) => d.labelNegative, dy: "0.3em", textAnchor: "start"}
                        )
                    )
                ]
            })
            plot.appendChild(chart);
        })
    })

    ;[boxplotCp, boxplotPre, boxplotHard, boxplotSocial, boxplotFa].forEach((plot, i) => {
        const datasets = results[Object.keys(results)[i]]

        function mapBarPlotData(data, group) {
            const sum = data.reduce((acc, {answer}) => acc + answer, 0)
            return data.map(({answer}, i, arr) => ({"Dark Pattern": group, Antwort: i + 1 - 3, "Anzahl": answer / sum}))
        }

        const usageData = [
        ...mapBarPlotData(datasets["dark pattern"][2].answers, "Mit"),
        ...mapBarPlotData(datasets["no dark pattern"][2].answers, "Ohne")
        ]

        const usageChart = Plot.plot({
            width: 400,
            x: {},
            y: {tickFormat: "%", grid: true},
            color: {scheme: "RdBu"},
            marks: [
                Plot.barY(usageData, {
                    x: "Dark Pattern",
                    y: "Anzahl",
                    fill: "Dark Pattern",
                    fx: "Antwort",
                    sort: {x: null, color: null, fx: {value: "x", reduce: "sum"}}
                }),
                Plot.ruleY([0])
            ]
        })
        plot.appendChild(usageChart);
    })
</script>
</body>

</html>